micro-nodejs:
  fullnameOverride: api
  deployment:
    replicas: 1
    image:
      pullPolicy: IfNotPresent
      repository: agnjunio/albion-killbot
      tag: 4.23.4
    ports:
      - name: http
        containerPort: 80
        protocol: TCP
    command:
    - /bin/bash
    - -c
    - npm run start:api
    env:
      - name: DISCORD_TOKEN
        valueFrom:
          secretKeyRef:
            name: discord-secrets
            key: DISCORD_TOKEN
      - name: DISCORD_CLIENT_ID
        valueFrom:
          secretKeyRef:
            name: discord-secrets
            key: DISCORD_CLIENT_ID
      - name: DISCORD_CLIENT_SECRET
        valueFrom:
          secretKeyRef:
            name: discord-secrets
            key: DISCORD_CLIENT_SECRET
      - name: DISCORD_COMMUNITY_ADMINS
        value: "187208303401500672"
      - name: DISCORD_COMMUNITY_SERVER
        value: "1242943818488352809"
      - name: MAX_PLAYERS
        value: "10"
      - name: MAX_GUILDS
        value: "1"
      - name: MAX_ALLIANCES
        value: "1"
      - name: DASHBOARD_URL
        value: https://albion-killbot-dashboard.k8scicd.local
      - name: AMQP_URL
        value: amqp://rabbitmq
      - name: MONGODB_URL
        value: mongodb://mongodb:27017/albion-killbot

  service:
    ports:
      - name: http-80
        port: 80
        protocol: TCP
        targetPort: http